name: Deploy to DigitalOcean Droplet
'on':
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:

      - name: Deploy to DigitalOcean Droplet
        uses: appleboy/ssh-action@master
        with:
          host: ${{secrets.DROPLET_IP}}
          username: ${{secrets.DROPLET_USERNAME}}
          key: ${{secrets.SSH_PRIVATE_KEY}}
          script: |
            npm install -g javascript-obfuscator
            cd /var/www/digitaldevops.com.mx/
            rm -rf library-v1
            git clone git@github.com:DigitalDevopsMaster/library-v1.git

            cd library-v1

            javascript-obfuscator ./crm-ui-v0.1.js --output ./crm-ui-v0.1-obfuscated.js
            javascript-obfuscator ./v2.js --output ./v2-obfuscated.js



            echo '------------------------------------'
            echo 'Deployment to digital ocean finished'
            echo '------------------------------------'




    